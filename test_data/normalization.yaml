test_information:
  name: normalize ZObject

test_objects:

  success:
    - name: simple reference
      object: Z4
      expected:
        Z1K1: Z9
        Z9K1: Z4

    - name: string unordered
      object: ba
      expected:
        Z1K1: Z6
        Z6K1: ba

    - name: untrimmed string left
      object: " a"
      expected:
        Z1K1: Z6
        Z6K1: " a"

    - name: untrimmed string right
      object: "a "
      expected:
        Z1K1: Z6
        Z6K1: "a "

    - name: untrimmed string left two
      object: "  a"
      expected:
        Z1K1: Z6
        Z6K1: "  a"

    - name: untrimmed string both
      object: " a "
      expected:
        Z1K1: Z6
        Z6K1: " a "

    - name: empty record with reference type
      object:
        Z1K1: Z1
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z1

    - name: simple record
      object:
        Z1K1: Z60
        Z60K1: a
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z60
        Z60K1:
          Z1K1: Z6
          Z6K1: a

    - name: escaped string
      object:
        Z1K1: Z6
        Z6K1: Z6
      expected:
        Z1K1: Z6
        Z6K1: Z6

    - name: escaped string QID
      object:
        Z1K1: Z6
        Z6K1: Q42
      expected:
        Z1K1: Z6
        Z6K1: Q42

    - name: potential key string
      object: Z1K1
      expected:
        Z1K1: Z6
        Z6K1: Z1K1

    - name: potential string key for Z0 (invalid ZID)
      object: Z0
      expected:
        Z1K1: Z6
        Z6K1: Z0

    - name: potential string key for K3 (local keys are not References)
      object: K3
      expected:
        Z1K1: Z6
        Z6K1: K3

    - name: string with wrong key
      object:
        Z1K1: Z6
        Z6K2: Z
      expected:
        Z1K1: Z6
        Z6K2:
          Z1K1: Z6
          Z6K1: Z

    - name: object with escaped string
      object:
        Z1K1: Z2
        Z2K2:
          Z1K1: Z6
          Z6K1: Z6
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z2
        Z2K2:
          Z1K1: Z6
          Z6K1: Z6

    - name: explicit reference
      object:
        Z1K1: Z2
        Z2K2: Z1
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z2
        Z2K2:
          Z1K1: Z9
          Z9K1: Z1

    - name: implicit reference
      object:
        Z1K1: Z2
        Z2K2: Z1
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z2
        Z2K2:
          Z1K1: Z9
          Z9K1: Z1

    - name: explicit QID reference
      object:
        Z1K1: Z2
        Z2K2: Q96807071
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z2
        Z2K2:
          Z1K1: Z9
          Z9K1: Q96807071

    - name: two strings in list
      object:
        - Z6
        - a
        - b
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z6
        K1:
          Z1K1: Z6
          Z6K1: a
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z6
          K1:
            Z1K1: Z6
            Z6K1: b
          K2:
            Z1K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z6

    - name: empty list of Z1s
      object:
        - Z1
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z1

    - name: empty list of lists of Z1s
      object:
        - Z1K1: Z7
          Z7K1: Z881
          Z881K1: Z1
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z1

    - name: list of lists of Z1s with one item that is an empty list of Z1s
      object:
        - Z1K1: Z7
          Z7K1: Z881
          Z881K1: Z1
        - [ Z1 ]
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z1
        K1:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z1
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z1

    - name: list of references
      object:
        - Z9
        - Z401
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z9
        K1:
          Z1K1: Z9
          Z9K1: Z401
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z9

    - name: objects in list
      object:
        - Z60
        - Z1K1: Z60
          Z60K1: en
        - Z1K1: Z60
          Z60K1: es
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z60
        K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z60
          Z60K1:
            Z1K1: Z6
            Z6K1: en
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z60
          K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z60
            Z60K1:
              Z1K1: Z6
              Z6K1: es
          K2:
            Z1K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z60

    - name: list object in object
      object:
        Z1K1: Z60
        Z60K1:
          - Z6
      expected:
        Z1K1:
          Z1K1: Z9
          Z9K1: Z60
        Z60K1:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z6

    - name: list with empty string
      object:
        - Z6
        - ""
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z6
        K1:
          Z1K1: Z6
          Z6K1: ""
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z6

    - name: list with two empty strings
      object:
        - Z6
        - ""
        - ""
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z6
        K1:
          Z1K1: Z6
          Z6K1: ""
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z6
          K1:
            Z1K1: Z6
            Z6K1: ""
          K2:
            Z1K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z6

    - name: list with lists
      object:
        - Z1
        - [ Z1 ]
        - [ Z1, [ Z1 ] ]
      expected:
        Z1K1:
          Z1K1:
            Z1K1: Z9
            Z9K1: Z7
          Z7K1:
            Z1K1: Z9
            Z9K1: Z881
          Z881K1:
            Z1K1: Z9
            Z9K1: Z1
        K1:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z1
        K2:
          Z1K1:
            Z1K1:
              Z1K1: Z9
              Z9K1: Z7
            Z7K1:
              Z1K1: Z9
              Z9K1: Z881
            Z881K1:
              Z1K1: Z9
              Z9K1: Z1
          K1:
            Z1K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z1
            K1:
              Z1K1:
                Z1K1:
                  Z1K1: Z9
                  Z9K1: Z7
                Z7K1:
                  Z1K1: Z9
                  Z9K1: Z881
                Z881K1:
                  Z1K1: Z9
                  Z9K1: Z1
            K2:
              Z1K1:
                Z1K1:
                  Z1K1: Z9
                  Z9K1: Z7
                Z7K1:
                  Z1K1: Z9
                  Z9K1: Z881
                Z881K1:
                  Z1K1: Z9
                  Z9K1: Z1
          K2:
            Z1K1:
              Z1K1:
                Z1K1: Z9
                Z9K1: Z7
              Z7K1:
                Z1K1: Z9
                Z9K1: Z881
              Z881K1:
                Z1K1: Z9
                Z9K1: Z1

  throws:
    - name: maleformed key
      object:
        Z1K1: Z9
        tuber: Z7
      errors:
        - Z502
        - Z525
