# This version of Z7 may only be used by the backend. Z7K2 distinguishes between
# cases where a Z7 should be executed and cases where it should not, e.g. when
# validating a Z7 using the built-in validators.
$id: Z7_backend
$ref: '#/definitions/objects/Z7_backend'
definitions:
  objects:
    Z7_backend:
      anyOf:
      - $ref: '#/definitions/objects/Z7_backend_literal'
      - $ref: Z9#/definitions/objects/Z9
      - $ref: Z18#/definitions/objects/Z18
    Z7_backend_literal:
      additionalProperties: false
      patternProperties:
        ^Z[1-9]\d*(K[1-9]\d*)?$:
          $ref: Z1#/definitions/objects/Z1
        # TODO (T288684): Support local keys in all relevant places.
        ^K[1-9]\d*$:
          $ref: Z1#/definitions/objects/Z1
      properties:
        Z1K1:
          allOf:
          - $ref: Z9#/definitions/objects/Z9
          - additionalProperties: false
            properties:
              Z1K1:
                enum:
                - Z9
                type: string
              Z9K1:
                enum:
                - Z7
                type: string
            required:
            - Z1K1
            - Z9K1
            type: object
        Z7K1:
          $ref: Z8#/definitions/objects/Z8
        Z7K2:
          $ref: Z40#/definitions/objects/Z40
      required:
      - Z1K1
      - Z7K1
      type: object
